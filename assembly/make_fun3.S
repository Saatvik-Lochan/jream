# THIS IS A FILE GENERATED BY meta_assembly_compile.py APPLIED ON make_fun3_m.S
# ASSUME s1 holds a pointer to the pcb
# ASSUME s2 holds a pointer to argument pointer array for all instr
# ASSUME s3 holds a pointer to the argument array for this instr
# ASSUME s4 holds a pointer to the array of all callable cxx funs
# ASSUME s5 holds a pointer to the X register array 

# load index
ld t2, 0(s3) # generated from 'load_arg t2, 0'
ld t1, 0(s1) # generated from 'load_shared t1, HTOP'

# num words to allocate is loaded into t0 before this snippet

# create and store header
addi t4, t0, -1  # subtract header word size
slli t3, t4, 6
addi t3, t3, 0b010100  # add this tag at the end
sd t3, 0(t1) 

# store index 
sd t2, 8(t1)

slli t0, t0, 3
add t5, t1, t0

sd t5, 0(s1) # generated from 'store_shared t5, HTOP'
